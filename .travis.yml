language: viml

install:
  - git clone https://github.com/thinca/vim-themis /tmp/themis
  - git clone https://github.com/syngan/vim-vimlint /tmp/vimlint
  - git clone https://github.com/ynkdir/vim-vimlparser /tmp/vimlparser
  - sudo pip install vim-vint

  - git clone https://github.com/vim/vim $HOME/vim
  - (if ! test -d $HOME/vim-7.4/bin; then cd $HOME/vim && git checkout . && git checkout v7.4 && ./configure --prefix=$HOME/vim-7.4 && make && make install; fi)
  - (if ! test -d $HOME/vim-7.4/bin; then cd $HOME/vim && git checkout . && git checkout v7.3.551 && ./configure --prefix=$HOME/vim-7.3.551 && make && make install; fi)
  - (if ! test -d $HOME/vim-7.3/bin; then cd $HOME/vim && git checkout . && git checkout v7.3 && ./configure --prefix=$HOME/vim-7.3 && make && make install; fi)

cache:
  directories:
    - $HOME/vim-7.4
    - $HOME/vim-7.3.551
    - $HOME/vim-7.3

script:
  - /tmp/themis/bin/themis --reporter tap
  - PATH=$HOME/vim-7.4/bin/:$PATH /tmp/themis/bin/themis --reporter tap
  - PATH=$HOME/vim-7.3.551/bin/:$PATH /tmp/themis/bin/themis --reporter tap
  - PATH=$HOME/vim-7.3/bin/:$PATH /tmp/themis/bin/themis --reporter tap

  - vint --version
  - vint plugin/ autoload/

  - sh /tmp/vimlint/bin/vimlint.sh -l /tmp/vimlint -p /tmp/vimlparser -e EVL103=1 -e EVL102.l:_=1 .
